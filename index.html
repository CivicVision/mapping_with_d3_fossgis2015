<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href="stylesheets/normalize.css" rel="stylesheet" type="text/css" /><link href="stylesheets/all.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <textarea id='source'>class: middle, center, inverse&#x000A;# Introduction to Mapping with d3&#x000A;Mila Frerichs&#x000A;&#x000A;---&#x000A;layout: true&#x000A;.footer[&#x000A;  <img src="/images/logo.png" height="20" />&#x000A;  .what[Mila Frerichs, Mapping in D3, FOSSGIS 2015]&#x000A;]&#x000A;&#x000A;---&#x000A;&#x000A;# Agenda&#x000A;&#x000A;1. Introduction&#x000A;&#x000A;--&#x000A;2. Challenge Overview&#x000A;&#x000A;--&#x000A;3. Lessons Learned&#x000A;&#x000A;--&#x000A;4. Outcome&#x000A;&#x000A;---&#x000A;class: center, middle&#x000A;# Introduction&#x000A;## Who are you?&#x000A;--&#x000A;&#x000A;## What do you expect?&#x000A;---&#x000A;# Introduction&#x000A;Download Workshop files. Use the link "Workshop Installation" on your desktop.  &#x000A;Run the install.sh script. Password is user.  &#x000A;Visit http://localhost/d3/ on your browser  &#x000A;&#x000A;--&#x000A;&#x000A;Each challenge consists:&#x000A;&#x000A;- a Walkthrough by me (5-10 min)&#x000A;--&#x000A;&#x000A;- you working on the challenge (inlcudes up to two tasks) (15 min)&#x000A;--&#x000A;&#x000A;- a debrief where you show your solutions and I show you a possible one(10 min)&#x000A;&#x000A;--&#x000A;&#x000A;## Files&#x000A;the files are on your desktop and have a symlink into the local server directory&#x000A;---&#x000A;# How to show solutions?&#x000A;### Blocks for the resuce&#x000A;http://bl.ocks.org  &#x000A;a gist based simple viewer for examples  &#x000A;Create a [Gist](http://gist.github.com/) and use the id and your username for bl.ocks.org  &#x000A;#### An example&#x000A;http://bl.ocks.org/mbostock/c1c0426d50ca8a9f4c97&#x000A;---&#x000A;# Challenge Overview&#x000A;Challenges are in the folders with their appropriate name&#x000A;each challenge has &#x000A;- challenge.js&#x000A;- solution.js &#x000A;- index.html&#x000A;- Readme.&#x000A;---&#x000A;# Challenges&#x000A;## Three main challenges&#x000A;- Simple Map&#x000A;- Change Projection&#x000A;- Add Interaction&#x000A;&#x000A;--&#x000A;&#x000A;## two extra challenges&#x000A;- Chorolplet Map&#x000A;- label placement&#x000A;---&#x000A;class: center, middle&#x000A;### Let's get started&#x000A;---&#x000A;class: center, middle&#x000A;# Challenge 1&#x000A;## A simple Map&#x000A;Folder `challenge1`&#x000A;---&#x000A;# Selections&#x000A;## Select a single element&#x000A;```js&#x000A;var map=d3.select('#map');&#x000A;```&#x000A;Select the element with the id 'map'&#x000A;--&#x000A;&#x000A;## Select multiple elements&#x000A;```js&#x000A;var groups=d3.selectAll('.country');&#x000A;```&#x000A;Select all elements with the class country&#x000A;---&#x000A;# Selections&#x000A;<img src="/images/selections.png" width="100%" />&#x000A;---&#x000A;# Selections&#x000A;## Data&#x000A;```js&#x000A;data = ['a','c','e','g'];&#x000A;selection = d3.selectAll('.country').data(data);&#x000A;```&#x000A;---&#x000A;# Selections&#x000A;## enter()&#x000A;If the data object has no DOM element in the selection, then it’s considered an “enter”&#x000A;--&#x000A;&#x000A;## exit()&#x000A;If that data object is no longer present in the data set, it’s considered an “exit”&#x000A;--&#x000A;&#x000A;## update&#x000A;If the data object exists both in the data set and as a property of a DOM node in the selection, it’s considered an “update”.&#x000A;---&#x000A;# Challenge 1&#x000A;## A simple Map&#x000A;```js&#x000A;var countries=d3.select('svg g');&#x000A;```&#x000A;Select the first group(g) inside the svg&#x000A;--&#x000A;&#x000A;```js&#x000A;countries.selectAll('.country')&#x000A;```&#x000A;Select all elements with class 'country' inside countries (group inside svg)&#x000A;--&#x000A;&#x000A;```js&#x000A;.data(geojson.features).enter().append('path')&#x000A;```&#x000A;Select the appropriate element, enter the selection and add path elements&#x000A;---&#x000A;# Challenge 1&#x000A;## A simple Map&#x000A;```js&#x000A;.attr("d", path)&#x000A;```&#x000A;--&#x000A;or&#x000A;```js&#x000A;.attr("d", function(d) { return path(d); }&#x000A;```&#x000A;Add the d attribute and apply the result of the path function&#x000A;--&#x000A;&#x000A;## Add a class&#x000A;```js&#x000A;.attr('class','classname')&#x000A;```&#x000A;add a class with the name 'classname'&#x000A;---&#x000A;# Challenge 1&#x000A;## A simple Map - using topojson&#x000A;way faster for big data&#x000A;```js&#x000A;.data(topojson.feature(data, data.objects.europe).features)&#x000A;```&#x000A;> Returns the GeoJSON Feature or FeatureCollection for the specified object in the given topology. If the specified object is a GeometryCollection, a FeatureCollection is returned, and each geometry in the collection is mapped to a Feature. Otherwise, a Feature is returned.&#x000A;---&#x000A;class: center, middle&#x000A;### Now it's your turn!&#x000A;---&#x000A;class: center&#x000A;## Debrief&#x000A;### Show your solutions&#x000A;--&#x000A;&#x000A;### Where do you got stuck?&#x000A;--&#x000A;&#x000A;### fun/hard/frustrating parts?&#x000A;---&#x000A;class: middle&#x000A;# Solution Challenge 1&#x000A;```js&#x000A;d3.json("data/eu.json", function(data) {&#x000A;  countries.selectAll('.country')&#x000A;  .data(topojson.feature(data, data.objects.europe).features)&#x000A;  .enter()&#x000A;  .append('path')&#x000A;  .attr('class', 'country')&#x000A;  .attr('d', path);&#x000A;});&#x000A;```&#x000A;or&#x000A;```js&#x000A;d3.json("data/eu.geojson", function(data) {&#x000A;  countries.selectAll('.country')&#x000A;  .data(data.features)&#x000A;  .enter()&#x000A;  .append('path')&#x000A;  .attr('class', 'country')&#x000A;  .attr('d', path);&#x000A;});&#x000A;```&#x000A;---&#x000A;class: center, middle&#x000A;# Challenge 2&#x000A;## Change the Projection&#x000A;---&#x000A;# Projections in D3&#x000A;## plenty different choices&#x000A;--&#x000A;&#x000A;- Mercator&#x000A;--&#x000A;&#x000A;- Albert&#x000A;--&#x000A;&#x000A;- Natural Earth&#x000A;- ..  &#x000A;&#x000A;More infos here:&#x000A;https://github.com/d3/d3-geo-projection&#x000A;---&#x000A;# Projections&#x000A;```js&#x000A;d3.geo.mercator()&#x000A;```&#x000A;## Parameters&#x000A;parameter|explanation&#x000A;-------|------&#x000A;scale|projection’s scale factor to the specified value&#x000A;translate|projection’s translation offset to the specified two-element array [x, y]&#x000A;center|the center of the projection&#x000A;---&#x000A;# Projections&#x000A;## Default parameters&#x000A;parameter|value&#x000A;-------|------&#x000A;scale|150&#x000A;translate|[480, 250]&#x000A;center|defaults to ⟨0°,0°⟩&#x000A;---&#x000A;# Projections&#x000A;## Best practice&#x000A;use a scale that best fits your zoom level  &#x000A;use half width and half height for translate  &#x000A;center the map for your purpose  &#x000A;---&#x000A;# Satellite Projection&#x000A;## Tips & Tricks&#x000A;important parameters&#x000A;&#x000A;parameter|description|default&#x000A;----|----&#x000A;rotate|longitude, latitude and roll in degrees|[0, 0, 0]&#x000A;distance|distance above the sphere’s surface|1.4&#x000A;tilt|tilt angle in degrees|0&#x000A;???&#x000A;default flipped y-coordinate&#x000A;---&#x000A;# Rotation&#x000A;http://bl.ocks.org/mbostock/raw/4282586/&#x000A;---&#x000A;# Challenge 2&#x000A;## Change the projection&#x000A;### Task 1: Natural Earth projection&#x000A;&#x000A;--&#x000A;### Task 2: Satellite projection&#x000A;---&#x000A;class: center, middle&#x000A;### Now it's your turn!&#x000A;---&#x000A;class: center&#x000A;## Debrief&#x000A;### Show your solutions&#x000A;--&#x000A;&#x000A;### Where do you got stuck?&#x000A;--&#x000A;&#x000A;### fun/hard/frustrating parts?&#x000A;---&#x000A;# Challenge 2&#x000A;## Solution Task 1&#x000A;```js&#x000A;width = 300;&#x000A;center = [5, 70];&#x000A;scale = 600;&#x000A;projection = d3.geo.naturalEarth().scale(scale).translate([width / 2, 0]).center(center);&#x000A;```&#x000A;---&#x000A;# Challenge 2&#x000A;## Solution Task 2&#x000A;```js&#x000A;scale = 550;&#x000A;distance = 1.1;&#x000A;rotate = [7, -50.3849401, -55];&#x000A;tilt = 20;&#x000A;projection = d3.geo.satellite().translate([width / 2, 0]).distance(distance).scale(scale).rotate(rotate).tilt(tilt);&#x000A;```&#x000A;---&#x000A;class: middle, center&#x000A;# Challenge 3&#x000A;## Add interaction&#x000A;---&#x000A;# Interactions&#x000A;- mouseover&#x000A;--&#x000A;&#x000A;- mouseout  &#x000A;--&#x000A;&#x000A;- mousemove  &#x000A;--&#x000A;&#x000A;- click&#x000A;--&#x000A;&#x000A;- doubleclick&#x000A;--&#x000A;&#x000A;- etc&#x000A;&#x000A;Any DOM event type supported by your browser may be used.&#x000A;&#x000A;--&#x000A;&#x000A;## Usage&#x000A;```js&#x000A;d3.select('element').on('mouseover', function(d,i) { return this; });&#x000A;```&#x000A;d is the datum associated with the element, i is the index and this is the element itself&#x000A;---&#x000A;# Interactions - Helper Methods&#x000A;### classed()&#x000A;> This operator is a convenience routine for setting the "class" attribute&#x000A;&#x000A;```js&#x000A;d3.select('.element').classed('active', true)&#x000A;d3.select('.element').classed('active', false)&#x000A;```&#x000A;???&#x000A;Das fügt nur eine Klasse hinzu!!&#x000A;--&#x000A;&#x000A;### d3.event&#x000A;```js&#x000A;d3.event.pageX&#x000A;d3.event.pageY&#x000A;```&#x000A;---&#x000A;# Tooltips&#x000A;## Tips & Tricks&#x000A;Add a element to the body and position it absolute&#x000A;use d3.event.pageX to use mouseposition to position the element&#x000A;```js&#x000A;.on("mousemove", function(d) {&#x000A;  d3.select("#tooltip").style("left", (d3.event.pageX + 10) + "px")&#x000A;  .style("top", (d3.event.pageY - 20) + "px")&#x000A;})&#x000A;.on("mouseover", function(d) {&#x000A;  d3.select("#tooltip").html(d).style("opacity",1)&#x000A;});&#x000A;```&#x000A;---&#x000A;# Challenge 3&#x000A;## Add interactions&#x000A;### Task 1: Highlight current country&#x000A;--&#x000A;&#x000A;### Task 2: Display tooltip&#x000A;---&#x000A;class: center, middle&#x000A;### Now it's your turn!&#x000A;---&#x000A;class: center&#x000A;## Debrief&#x000A;### Show your solutions&#x000A;--&#x000A;&#x000A;### Where do you got stuck?&#x000A;--&#x000A;&#x000A;### fun/hard/frustrating parts?&#x000A;---&#x000A;# Challenge 3&#x000A;## Solution Task 1&#x000A;```js&#x000A;.on('mouseover', function(d) {&#x000A;  return d3.select(this).classed("active", true);&#x000A;}).on('mouseout', function(d) {&#x000A;  return d3.select(this).classed("active", false);&#x000A;});&#x000A;```&#x000A;```css&#x000A;.country.active {&#x000A;  fill: #f00;&#x000A;}&#x000A;```&#x000A;&#x000A;---&#x000A;# Challenge 3&#x000A;## Solution Task 2&#x000A;```js&#x000A;.on("mousemove", function(d) {&#x000A;  d3.select("#tooltip").style("left", (d3.event.pageX + 10) + "px")&#x000A;  .style("top", (d3.event.pageY - 20) + "px")&#x000A;})&#x000A;.on("mouseover", function(d) {&#x000A;  d3.select("#tooltip").html(d.properties.name).style("opacity",1)&#x000A;});&#x000A;```&#x000A;&#x000A;&#x000A;---&#x000A;class: middle, center&#x000A;# Lessons Learned&#x000A;---&#x000A;class: middle, center&#x000A;# Outcome&#x000A;---&#x000A;class: middle, center&#x000A;# Extra Challenges&#x000A;---&#x000A;class: middle, center&#x000A;# Challenge 4&#x000A;## Choroplet Map&#x000A;---&#x000A;class: center, middle&#x000A;# Idea&#x000A;fill the polygons with a color&#x000A;use scales to find the correct color for the data&#x000A;---&#x000A;# Scales&#x000A;```js&#x000A;d3.scale.quantile()&#x000A;```&#x000A;https://github.com/mbostock/d3/wiki/Quantitative-Scales#quantile-scales&#x000A;## Example&#x000A;```js&#x000A;var domain = [1,2,3,4,5];&#x000A;var range = ['red','green','blue','yellow','magenta'];&#x000A;scale = d3.scale.quantile().domain(domain).range(range);&#x000A;scale(1);&#x000A;# => "red"&#x000A;scale(3)&#x000A;# => 'blue'&#x000A;```&#x000A;---&#x000A;# Colors&#x000A;## Colorbrewer&#x000A;```js&#x000A;colors = colorbrewer.Reds[8]&#x000A;# => ["#fff5f0", "#fee0d2", "#fcbba1", "#fc9272", "#fb6a4a", "#ef3b2c", "#cb181d", "#99000d"]&#x000A;```&#x000A;---&#x000A;# Styles&#x000A;```js&#x000A;d3.select('element').attr('fill','#ffffff')&#x000A;d3.select('element').attr('stroke','#ffffff')&#x000A;```&#x000A;---&#x000A;# Helpers&#x000A;## max/min&#x000A;```js&#x000A;d3.max(data, function(d) { return d.count; });&#x000A;# => 0 (number)&#x000A;d3.min(data, function(d) { return d.count; });&#x000A;# => 0 (number)&#x000A;```&#x000A;## extend&#x000A;```js&#x000A;d3.extend(data, function(d) { return d.count; });&#x000A;# => [min,max]&#x000A;```&#x000A;---&#x000A;class: center, middle&#x000A;### Now it's your turn!&#x000A;---&#x000A;class: middle, center&#x000A;# Challenge 5&#x000A;## Label placement&#x000A;---&#x000A;class: center, middle&#x000A;# Idea&#x000A;add a text field to the map and center the label inside the polygon&#x000A;---&#x000A;# Text&#x000A;```js&#x000A;.append("text")&#x000A;.text("Text")&#x000A;```&#x000A;--&#x000A;&#x000A;# Centroid&#x000A;> Computes the projected centroid (in pixels) for the specified feature.&#x000A;&#x000A;```js&#x000A;path.centroid(d)&#x000A;# => 300,40&#x000A;```&#x000A;---&#x000A;# Transform&#x000A;most important transformation for d3: translate&#x000A;> This transform specifies a translation by x and y. If y is not provided, it is assumed to be zero.&#x000A;&#x000A;```js&#x000A;.attr("transform", "translate(10,10)")&#x000A;```&#x000A;---&#x000A;class: center, middle&#x000A;### Now it's your turn!&#x000A;---&#x000A;class: center, middle&#x000A;# Thanks</textarea>
  </body>
  <script src="javascripts/all.js" type="text/javascript"></script>
  <script>
    var slideshow = remark.create({
    highlighLanguage: 'js',
    highlightStyle: 'tomorrow-night-eighties'
    });
  </script>
</html>
